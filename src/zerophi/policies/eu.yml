# EU GDPR-compliant PII patterns and policies
regex_patterns:
  # Personal Identifiers
  PERSON_NAME: '\b([A-Z][a-z]+\s[A-Z][a-z]+(?:\s[A-Z][a-z]+)?)\b'
  
  # Email Addresses
  EMAIL: '[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}'
  
  # Phone Numbers (international format)
  PHONE_EU: '\+(?:[0-9]\s?){6,14}[0-9]'
  PHONE_UK: '\b(?:\+44|0)(?:\d\s?){10}\b'
  PHONE_DE: '\b(?:\+49|0)(?:\d\s?){10,11}\b'
  PHONE_FR: '\b(?:\+33|0)(?:\d\s?){9}\b'
  
  # Dates
  DOB_EU: '\b(0?[1-9]|[12]\d|3[01])[./](0?[1-9]|1[0-2])[./](19|20)\d{2}\b'
  DOB_ISO: '\b(19|20)\d{2}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])\b'
  
  # National ID Numbers (various EU countries)
  
  # UK National Insurance Number
  UK_NINO: '\b[A-CEGHJ-PR-TW-Z]{1}[A-CEGHJ-NPR-TW-Z]{1}[0-9]{6}[A-D]{1}\b'
  
  # German Personal ID (Personalausweisnummer)
  DE_PERSONAL_ID: '\b[A-Z]{1}[0-9]{8}\b'
  
  # French Social Security Number (INSEE)
  FR_INSEE: '\b[12][0-9]{2}(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])[0-9]{2}[0-9]{3}[0-9]{2}\b'
  
  # Italian Fiscal Code (Codice Fiscale)
  IT_FISCAL_CODE: '\b[A-Z]{6}[0-9]{2}[A-Z][0-9]{2}[A-Z][0-9]{3}[A-Z]\b'
  
  # Spanish DNI/NIE
  ES_DNI: '\b[0-9]{8}[A-Z]\b'
  ES_NIE: '\b[XYZ][0-9]{7}[A-Z]\b'
  
  # Dutch BSN (Burgerservicenummer)
  NL_BSN: '\b[0-9]{8,9}\b'
  
  # IBAN (International Bank Account Number)
  IBAN: '\b[A-Z]{2}[0-9]{2}[A-Z0-9]{4}[0-9]{7}([A-Z0-9]?){0,16}\b'
  
  # Credit Card Numbers
  CREDIT_CARD: '\b(?:\d{4}[-\s]?){3}\d{4}\b'
  
  # IP Addresses
  IP_ADDRESS: '\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b'
  
  # IPv6 Addresses
  IPV6_ADDRESS: '\b(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}\b'
  
  # MAC Addresses
  MAC_ADDRESS: '\b([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})\b'
  
  # URLs
  URL: 'https?://[^\s<>"{}|\\^`\[\]]+|www\.[^\s<>"{}|\\^`\[\]]+\.[a-z]{2,}'
  
  # EU Addresses (simplified)
  EU_ADDRESS: '\b\d+\s+([A-Z][a-z]+\s+)+(Street|St|Avenue|Ave|Road|Rd|Lane|Ln|Stra√üe|Str|Rue|Via|Calle)\b'
  
  # Postal Codes (various EU formats)
  POSTAL_CODE_UK: '\b[A-Z]{1,2}[0-9R][0-9A-Z]?\s?[0-9][A-Z]{2}\b'
  POSTAL_CODE_DE: '\b[0-9]{5}\b'
  POSTAL_CODE_FR: '\b[0-9]{5}\b'
  POSTAL_CODE_IT: '\b[0-9]{5}\b'
  POSTAL_CODE_ES: '\b[0-9]{5}\b'
  POSTAL_CODE_NL: '\b[0-9]{4}\s?[A-Z]{2}\b'
  
  # Medical IDs
  MEDICAL_RECORD: '\b(patient id|medical record|chart number)\s*:?\s*([A-Z0-9]{6,12})\b'
  
  # Healthcare Professional IDs
  HEALTHCARE_ID: '\b(healthcare id|professional id)\s*:?\s*([A-Z0-9]{6,15})\b'
  
  # Vehicle Registration
  EU_LICENSE_PLATE: '\b[A-Z]{1,3}[-\s]?[0-9]{1,4}[-\s]?[A-Z]{1,3}\b'
  
  # Passport Numbers
  PASSPORT: '\b(passport)\s*(?:number|#)?\s*:?\s*([A-Z0-9]{6,9})\b'
  
  # Driver's License
  DRIVERS_LICENSE: '\b(driving licence|driver license)\s*(?:number|#)?\s*:?\s*([A-Z0-9]{6,15})\b'

# GDPR-compliant redaction actions
actions:
  default: 'hash'
  PERSON_NAME: 'synthetic'
  EMAIL: 'preserve_format'
  PHONE_EU: 'preserve_format'
  PHONE_UK: 'preserve_format'
  PHONE_DE: 'preserve_format'
  PHONE_FR: 'preserve_format'
  DOB_EU: 'synthetic'
  DOB_ISO: 'synthetic'
  UK_NINO: 'replace'
  DE_PERSONAL_ID: 'replace'
  FR_INSEE: 'replace'
  IT_FISCAL_CODE: 'replace'
  ES_DNI: 'replace'
  ES_NIE: 'replace'
  NL_BSN: 'replace'
  IBAN: 'encrypt'
  CREDIT_CARD: 'mask'
  IP_ADDRESS: 'mask'
  IPV6_ADDRESS: 'mask'
  MAC_ADDRESS: 'hash'
  URL: 'brackets'
  EU_ADDRESS: 'synthetic'
  POSTAL_CODE_UK: 'preserve_format'
  POSTAL_CODE_DE: 'preserve_format'
  POSTAL_CODE_FR: 'preserve_format'
  POSTAL_CODE_IT: 'preserve_format'
  POSTAL_CODE_ES: 'preserve_format'
  POSTAL_CODE_NL: 'preserve_format'
  MEDICAL_RECORD: 'replace'
  HEALTHCARE_ID: 'replace'
  EU_LICENSE_PLATE: 'hash'
  PASSPORT: 'replace'
  DRIVERS_LICENSE: 'replace'

# GDPR compliance settings
compliance:
  standard: 'GDPR'
  lawful_basis_required: true
  consent_management: true
  right_to_erasure: true
  data_portability: true
  privacy_by_design: true
  
  # Article 4 GDPR personal data categories
  personal_data_categories:
    - 'PERSON_NAME'
    - 'EMAIL'
    - 'PHONE_EU'
    - 'DOB_EU'
    - 'UK_NINO'
    - 'DE_PERSONAL_ID'
    - 'FR_INSEE'
    - 'IT_FISCAL_CODE'
    - 'ES_DNI'
    - 'ES_NIE'
    - 'NL_BSN'
    - 'EU_ADDRESS'
    - 'IP_ADDRESS'
    - 'IBAN'
    - 'CREDIT_CARD'
    - 'MEDICAL_RECORD'
    - 'BIOMETRIC_DATA'
    - 'GENETIC_DATA'
    - 'HEALTH_DATA'
    - 'SEX_LIFE_DATA'
    - 'POLITICAL_OPINION'
    - 'RELIGIOUS_BELIEF'
    - 'TRADE_UNION'
    - 'RACIAL_ORIGIN'
  
  # Special categories (Article 9 GDPR)
  special_categories:
    - 'BIOMETRIC_DATA'
    - 'GENETIC_DATA'
    - 'HEALTH_DATA'
    - 'SEX_LIFE_DATA'
    - 'POLITICAL_OPINION'
    - 'RELIGIOUS_BELIEF'
    - 'TRADE_UNION'
    - 'RACIAL_ORIGIN'

# Data retention policies
retention:
  default_period: '7_years'
  special_categories_period: '3_years'
  consent_based_period: 'until_withdrawn'
  
# Cross-border transfer restrictions
transfer_restrictions:
  adequacy_decision_required: true
  safeguards_required: true
  derogation_conditions: true

# Entity confidence thresholds
thresholds:
  UK_NINO: 0.95
  IBAN: 0.95
  CREDIT_CARD: 0.95
  EMAIL: 0.90
  PHONE_EU: 0.85
  MEDICAL_RECORD: 0.90