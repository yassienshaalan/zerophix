# UK-specific PII patterns and policies (post-Brexit)
regex_patterns:
  # Personal Identifiers
  PERSON_NAME: '\b([A-Z][a-z]+\s[A-Z][a-z]+(?:\s[A-Z][a-z]+)?)\b'
  
  # National Insurance Number
  UK_NINO: '\b[A-CEGHJ-PR-TW-Z]{1}[A-CEGHJ-NPR-TW-Z]{1}[0-9]{6}[A-D]{1}\b'
  
  # NHS Number
  NHS_NUMBER: '\b(\d{3}\s?\d{3}\s?\d{4})\b'
  
  # UK Phone Numbers
  PHONE_UK: '\b(?:\+44|0)(?:\d\s?){10}\b'
  MOBILE_UK: '\b(?:\+44\s?7|07)(?:\d\s?){9}\b'
  
  # Email Addresses
  EMAIL: '[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}'
  
  # Dates
  DOB_UK: '\b(0?[1-9]|[12]\d|3[01])[./](0?[1-9]|1[0-2])[./](19|20)\d{2}\b'
  DOB_ISO: '\b(19|20)\d{2}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])\b'
  
  # UK Postcodes
  UK_POSTCODE: '\b[A-Z]{1,2}[0-9R][0-9A-Z]?\s?[0-9][A-Z]{2}\b'
  
  # UK Bank Details
  UK_SORT_CODE: '\b(\d{2}[-\s]?\d{2}[-\s]?\d{2})\b'
  UK_ACCOUNT_NUMBER: '\b(account|acct)\s*(?:number|#)?\s*:?\s*(\d{8})\b'
  
  # UK Driving License
  UK_DRIVING_LICENSE: '\b([A-Z]{5}[0-9]{6}[A-Z]{2}[0-9]{2})\b'
  
  # UK Passport
  UK_PASSPORT: '\b[0-9]{9}\b'
  
  # UK Vehicle Registration
  UK_REG_PLATE: '\b[A-Z]{2}[0-9]{2}\s?[A-Z]{3}\b'
  
  # Credit Card Numbers
  CREDIT_CARD: '\b(?:\d{4}[-\s]?){3}\d{4}\b'
  
  # UTR (Unique Taxpayer Reference)
  UK_UTR: '\b([0-9]{10})\b'
  
  # VAT Registration Number
  UK_VAT: '\bGB\s?([0-9]{9}|[0-9]{12})\b'
  
  # Company Registration Number
  UK_COMPANY_NUMBER: '\b([0-9]{8}|[A-Z]{2}[0-9]{6})\b'
  
  # Medical Records
  MEDICAL_RECORD: '\b(patient id|medical record|hospital number)\s*:?\s*([A-Z0-9]{6,12})\b'
  
  # GP Practice Code
  GP_PRACTICE_CODE: '\b[A-Z][0-9]{5}\b'
  
  # GMC Number (General Medical Council)
  GMC_NUMBER: '\bGMC\s*:?\s*([0-9]{7})\b'
  
  # NMC PIN (Nursing and Midwifery Council)
  NMC_PIN: '\bNMC\s*:?\s*([0-9]{2}[A-Z][0-9]{4}[A-Z])\b'
  
  # UK Addresses
  UK_ADDRESS: '\b\d+\s+([A-Z][a-z]+\s+)+(Street|St|Avenue|Ave|Road|Rd|Lane|Ln|Drive|Dr|Close|Cl|Court|Ct|Place|Pl|Crescent|Cres|Gardens|Gdns)\b'
  
  # IP Addresses
  IP_ADDRESS: '\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b'
  
  # URLs
  URL: 'https?://[^\s<>"{}|\\^`\[\]]+|www\.[^\s<>"{}|\\^`\[\]]+\.[a-z]{2,}'

# UK Data Protection Act 2018 compliant redaction actions
actions:
  default: 'hash'
  PERSON_NAME: 'synthetic'
  UK_NINO: 'replace'
  NHS_NUMBER: 'replace'
  PHONE_UK: 'preserve_format'
  MOBILE_UK: 'preserve_format'
  EMAIL: 'preserve_format'
  DOB_UK: 'synthetic'
  DOB_ISO: 'synthetic'
  UK_POSTCODE: 'preserve_format'
  UK_SORT_CODE: 'replace'
  UK_ACCOUNT_NUMBER: 'encrypt'
  UK_DRIVING_LICENSE: 'replace'
  UK_PASSPORT: 'replace'
  UK_REG_PLATE: 'hash'
  CREDIT_CARD: 'mask'
  UK_UTR: 'replace'
  UK_VAT: 'replace'
  UK_COMPANY_NUMBER: 'hash'
  MEDICAL_RECORD: 'replace'
  GP_PRACTICE_CODE: 'replace'
  GMC_NUMBER: 'replace'
  NMC_PIN: 'replace'
  UK_ADDRESS: 'synthetic'
  IP_ADDRESS: 'mask'
  URL: 'brackets'

# UK Data Protection compliance settings
compliance:
  standard: 'UK_DPA_2018'
  gdpr_aligned: true
  ico_guidance: true
  
  # Lawful bases under UK DPA 2018
  lawful_bases:
    - 'consent'
    - 'contract'
    - 'legal_obligation'
    - 'vital_interests'
    - 'public_task'
    - 'legitimate_interests'
  
  # Special category data (Schedule 1)
  special_categories:
    - 'racial_ethnic_origin'
    - 'political_opinions'
    - 'religious_beliefs'
    - 'trade_union_membership'
    - 'genetic_data'
    - 'biometric_data'
    - 'health_data'
    - 'sex_life_data'
    - 'sexual_orientation'
  
  # Criminal offence data (Part 3 Chapter 3)
  criminal_offence_data:
    - 'criminal_convictions'
    - 'criminal_allegations'
    - 'criminal_proceedings'

# NHS and healthcare specific settings
healthcare:
  nhs_data_security_standards: true
  information_governance_toolkit: true
  caldicott_principles: true
  
  # NHS Digital requirements
  nhs_digital_compliance: true
  
  # Care Quality Commission requirements
  cqc_compliance: true

# Financial services compliance
financial:
  fca_regulations: true
  pci_dss: true
  open_banking: true
  
  # Anti-money laundering
  aml_compliance: true

# Entity confidence thresholds
thresholds:
  UK_NINO: 0.95
  NHS_NUMBER: 0.95
  UK_DRIVING_LICENSE: 0.90
  UK_POSTCODE: 0.90
  UK_SORT_CODE: 0.95
  UK_ACCOUNT_NUMBER: 0.90
  CREDIT_CARD: 0.95
  EMAIL: 0.90
  PHONE_UK: 0.85
  MEDICAL_RECORD: 0.90
  GMC_NUMBER: 0.95
  NMC_PIN: 0.95