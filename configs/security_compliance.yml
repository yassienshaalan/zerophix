# ZeroPhi Security and Compliance Configuration
# This configuration ensures adherence to major privacy and security regulations

# General Security Settings
security:
  encryption_at_rest: true
  audit_logging: true
  zero_trust_mode: true
  session_timeout_minutes: 30
  max_failed_logins: 3
  require_mfa: false  # Set to true for production
  api_rate_limiting: true
  
  # Key management
  key_rotation_days: 90
  master_key_backup: true
  key_escrow: false
  
  # Network security
  tls_min_version: "1.3"
  require_secure_headers: true
  cors_strict_mode: false  # Set to true for production
  
  # Password policy
  password_policy:
    min_length: 12
    require_uppercase: true
    require_lowercase: true
    require_numbers: true
    require_symbols: true
    prevent_reuse: 12  # Last 12 passwords

# Compliance Standards Configuration
compliance:
  # Active standards
  enabled_standards:
    - "GDPR"      # General Data Protection Regulation (EU)
    - "HIPAA"     # Health Insurance Portability and Accountability Act (US)
    - "CCPA"      # California Consumer Privacy Act (US)
    - "UK_DPA_2018"  # UK Data Protection Act 2018
    - "PIPEDA"    # Personal Information Protection and Electronic Documents Act (CA)
    - "PCI_DSS"   # Payment Card Industry Data Security Standard
  
  # GDPR Specific Settings
  gdpr:
    data_controller: "Your Organization Name"
    data_protection_officer: "dpo@yourorganization.com"
    lawful_basis_tracking: true
    consent_management: true
    data_subject_rights:
      right_to_access: true
      right_to_rectification: true
      right_to_erasure: true
      right_to_portability: true
      right_to_object: true
      right_to_restrict: true
    breach_notification:
      enabled: true
      authority_notification_hours: 72
      data_subject_notification_required: true
    cross_border_transfers:
      adequacy_decisions: true
      standard_contractual_clauses: true
      binding_corporate_rules: false
  
  # HIPAA Specific Settings
  hipaa:
    covered_entity: true
    business_associate: false  # Set to true if acting as BA
    minimum_necessary_standard: true
    administrative_safeguards:
      security_officer: true
      workforce_training: true
      access_management: true
      contingency_plan: true
    physical_safeguards:
      facility_access: true
      workstation_security: true
      device_controls: true
    technical_safeguards:
      access_control: true
      audit_controls: true
      integrity: true
      transmission_security: true
    breach_notification:
      hhs_notification_days: 60
      individual_notification_days: 60
      media_notification_threshold: 500
  
  # PCI DSS Settings
  pci_dss:
    merchant_level: 4  # Set appropriate level (1-4)
    cardholder_data_environment: false
    requirements:
      secure_network: true
      protect_cardholder_data: true
      vulnerability_management: true
      access_control: true
      monitoring: true
      information_security_policy: true

# Data Classification and Handling
data_classification:
  # Classification levels
  levels:
    PUBLIC:
      retention_days: 365
      encryption_required: false
      access_logging: false
      approval_required: false
    INTERNAL:
      retention_days: 1095  # 3 years
      encryption_required: true
      access_logging: true
      approval_required: false
    SENSITIVE:
      retention_days: 2555  # 7 years
      encryption_required: true
      access_logging: true
      approval_required: true
      special_handling: true
    RESTRICTED:
      retention_days: 2555  # 7 years
      encryption_required: true
      access_logging: true
      approval_required: true
      special_handling: true
      executive_approval: true
  
  # Automatic classification rules
  auto_classification:
    enabled: true
    rules:
      - pattern: "SSN|Social Security"
        classification: "RESTRICTED"
      - pattern: "Credit Card|Card Number"
        classification: "RESTRICTED"
      - pattern: "Medical Record|Patient"
        classification: "SENSITIVE"
      - pattern: "Email|Phone"
        classification: "SENSITIVE"

# Privacy Settings
privacy:
  # Privacy by Design principles
  privacy_by_design: true
  privacy_by_default: true
  
  # Data minimization
  data_minimization: true
  purpose_limitation: true
  storage_limitation: true
  
  # Technical privacy measures
  differential_privacy:
    enabled: true
    epsilon: 1.0  # Privacy budget
    delta: 1e-5   # Privacy parameter
  
  k_anonymity:
    enabled: true
    k_value: 5
  
  synthetic_data:
    enabled: true
    quality_threshold: 0.8
  
  # Consent management
  consent:
    granular_consent: true
    consent_withdrawal: true
    consent_expiry_days: 365
    parental_consent: true  # For minors

# Audit and Monitoring
audit:
  # General settings
  enabled: true
  real_time_monitoring: true
  retention_days: 2555  # 7 years
  
  # Log levels
  log_levels:
    api_access: "INFO"
    data_processing: "INFO"
    security_events: "WARNING"
    compliance_violations: "ERROR"
    system_errors: "ERROR"
  
  # What to log
  log_events:
    - "data_access"
    - "data_modification"
    - "user_authentication"
    - "permission_changes"
    - "system_configuration"
    - "data_export"
    - "data_deletion"
    - "security_incidents"
  
  # Log encryption
  encrypt_logs: true
  log_integrity_checking: true
  
  # Monitoring and alerting
  alerts:
    unusual_access_patterns: true
    failed_login_attempts: true
    bulk_data_access: true
    after_hours_access: true
    geographic_anomalies: true
    privilege_escalation: true

# Incident Response
incident_response:
  enabled: true
  
  # Incident types
  incident_types:
    data_breach:
      severity: "CRITICAL"
      notification_required: true
      regulatory_reporting: true
      max_response_time_hours: 1
    
    unauthorized_access:
      severity: "HIGH"
      notification_required: true
      regulatory_reporting: false
      max_response_time_hours: 4
    
    system_compromise:
      severity: "CRITICAL"
      notification_required: true
      regulatory_reporting: true
      max_response_time_hours: 1
    
    compliance_violation:
      severity: "MEDIUM"
      notification_required: true
      regulatory_reporting: true
      max_response_time_hours: 24
  
  # Response procedures
  automated_response:
    account_lockout: true
    system_isolation: false  # Manual approval required
    data_loss_prevention: true
    log_preservation: true
  
  # Notifications
  notification_channels:
    email: true
    sms: false
    webhook: true
    dashboard: true

# Data Subject Rights (GDPR/CCPA)
data_subject_rights:
  # Request processing
  automated_processing: false  # Manual review required
  response_time_days: 30
  identity_verification: true
  
  # Supported requests
  supported_requests:
    - "access"        # Right to access
    - "rectification" # Right to correct
    - "erasure"       # Right to be forgotten
    - "portability"   # Right to data portability
    - "restriction"   # Right to restrict processing
    - "objection"     # Right to object
  
  # Request tracking
  request_tracking: true
  approval_workflow: true

# Vendor and Third-Party Management
vendor_management:
  # Due diligence requirements
  security_assessments: true
  privacy_impact_assessments: true
  data_processing_agreements: true
  
  # Ongoing monitoring
  periodic_reviews: true
  review_frequency_months: 12
  incident_reporting: true
  
  # Approved vendors
  vendor_whitelist: []
  
# International Data Transfers
international_transfers:
  # Transfer mechanisms
  adequacy_decisions: true
  standard_contractual_clauses: true
  binding_corporate_rules: false
  certification_schemes: true
  codes_of_conduct: true
  
  # Restricted countries
  restricted_countries: []
  
  # Transfer logging
  log_transfers: true
  impact_assessments: true

# Business Continuity and Disaster Recovery
business_continuity:
  backup_retention_days: 2555  # 7 years
  backup_encryption: true
  disaster_recovery_plan: true
  
  # Recovery objectives
  rpo_hours: 24   # Recovery Point Objective
  rto_hours: 48   # Recovery Time Objective
  
  # Testing
  testing_frequency_months: 6
  test_documentation: true